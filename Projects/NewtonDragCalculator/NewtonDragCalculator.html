<!--Made Febrary 5th    -->

<!DOCTYPE html> 
<html>
    <head>
        <title> Newton Drag Calculator </title>
    </head>

    <body>

        <!--Displaying cookies-->
        <button onclick = "run()" class = "button">
            Run
        </button>
 
        <button onclick = "restart()" class = "button">
            Restart
        </button>

        <br>
        <!--Input density and Drag coefficient-->

        Density :<input type = "range" min = "0" max = "100" value = "0" id = "density" class = "slider"> 
        <br>

        Drag coefficient :<input type = "range" min = "0" max = "100" value = "0" id = "coefficient" class = "slider">

        
        <canvas id = "myCanvas" style = "border: 2px solid" ></canvas>

        <!-- Values -->
        <br>

        Density of the Air : <span style = "color:blue; font-weight:bold" id = "Density">50</span> <span style="color: blue; font-weight: bold">g/m^3</span>
        <br>

        Drag Coefficient : <span style = "color:blue; font-weight:bold" id = "Coefficient">50</span>

        <br>

        Cross sectional area : <span style = "color:blue; font-weight:bold" id = "Area">0</span> <span style="color: blue; font-weight: bold">m^2</span>

        <br>
        Total Distance Traveled horizontally : <span style = "color:blue; font-weight:bold" id = "Distance">0</span> <span style="color: blue; font-weight: bold">m</span>
        <br>


        <script>

            var cookies = 0;

            function add() {
                cookies += 1;
                document.getElementById("cookies").innerHTML = cookies;
            }

            // Canvas setup ---------

            var canvas = document.getElementById("myCanvas");
            var c = canvas.getContext("2d");
            canvas.width = window.innerWidth - 20;
            canvas.height = window.innerHeight - 160;

            var simMinWidth = 20.0;
            var cScale = Math.min(canvas.width, canvas.height) / simMinWidth;
            var simWidth = canvas.width / cScale;
            var simHeight = canvas.height / cScale;

            function cX(pos) {
                return pos.x * cScale;
            }

            function cY(pos) {
                return canvas.height - pos.y * cScale;
            }


            //Scene setup -------

            var timeSplit = 1.0 / 120.0;

            var gravity = {
                x : 0,
                y : -10
            }

            // Drag Equation
            //1/2 * (Density) * (velocity) ^2 * (Drag Coefficient) * Area

            var airdrag = {
                density : 0,
                coefficient : 0,
            }

            var totalDistance = {
                x : 0,
                y : 0,
                finished : 1
            }


            //BALL 
            var ballvel = {
                x : 30,
                y : 30
            }

            var ball = {
                radius : 0.5,
                pos : {x : function() {
                        return this.radius + 0.5
                    }, y : function() {
                        return this.radius
                    }
                    },
                vel : {x :  ballvel.x, y : ballvel.y},
                area : function() {
                    return 2.0 * Math.PI * this.radius;
                }
            };


            // Drawing ---------------
            function draw() {
                c.clearRect(0, 0, canvas.width, canvas.height);

                c.fillStyle = "#FF0000";

                c.beginPath();
                c.arc(
                    cX(ball.pos), cY(ball.pos), cScale * ball.radius, 0.0, 2.0 * Math.PI
                )
                c.closePath();
                c.fill();
            }

            document.getElementById("density").oninput = function() {
                airdrag.density = this.value;
            }
            document.getElementById("coefficient").oninput = function() {
                airdrag.coefficient = this.value;
            }
            


            //simulation ----------

            function simulate() {

                ball.vel.x += gravity.x * timeSplit;
                ball.vel.y += gravity.y * timeSplit;

                ball.pos.x += ball.vel.x * timeSplit;
                ball.pos.y += ball.vel.y * timeSplit;

                if (ball.pos.x <= ball.radius ) {
                    ball.pos.x = ball.radius;
                    ball.vel.x = -ball.vel.x;
                }
                if (ball.pos.x >= simWidth - ball.radius) {
                    ball.pos.x = simWidth - ball.radius;
                    ball.vel.x = -ball.vel.x;
                }
                if (ball.pos.y < ball.radius) {
                    ball.pos.y = ball.radius;
                    ball.vel.y = 0;
                    ball.vel.x = 0;
                    totalDistance.finished = 0;
                    end();
                }

                //Total distance calculated

                if (totalDistance.finished = 1) {
                totalDistance.x += Math.abs(ball.vel.x * timeSplit);
                }



                document.getElementById("Density").innerHTML = airdrag.density;
                document.getElementById("Coefficient").innerHTML = airdrag.coefficient;
                document.getElementById("Area").innerHTML = Math.round((ball.radius * 2 * Math.PI) * 100) / 100;

                document.getElementById("Distance").innerHTML = Math.round(totalDistance.x * 100) /100

            }

            //make browser to call us repeatedly ------------

            function update() {
                simulate();
                draw();
                requestAnimationFrame(update);
            }

            function run() {
                update();
            }
            function restart() {
                init();
            }

            function init() {
                ball.pos.x = ball.radius;
                ball.pos.y = ball.radius
                ball.vel.x = ballvel.x;
                ball.vel.y = ballvel.y;
                c.clearRect(0, 0, canvas.width, canvas.height);

                c.fillStyle = "#FF0000";

                c.beginPath();
                c.arc(
                    cX(ball.pos), cY(ball.pos), cScale * ball.radius, 0.0, 2.0 * Math.PI
                )
                c.closePath();
                c.fill();
            }

            init() 

        </script>
    </body>
</html>